Bootstrap: debootstrap
OSVersion: bionic
MirrorURL: http://us.archive.ubuntu.com/ubuntu/

%environment
    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8
    export LD_LIBRARY_PATH="/usr/local/lib:$LD_LIBRARY_PATH"

%post
%post
    apt update
    apt install -y software-properties-common
    apt-add-repository universe
    apt update
    apt install -y git wget build-essential unzip

#    apt-get install -y python3-setuptools \
#        python3-pkg-resources \
#        python3-distutils \
#        python3-lib2to3
#    apt install -y libidn11-dev
    apt-get -y install autoconf automake zlib1g-dev libbz2-dev liblzma-dev libcurl4-gnutls-dev libssl-dev libncurses5-dev


    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8
    {
        echo "export PATH=/usr/local:/usr/local/bin:/usr/local/lib:$PATH"
        echo "export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH"
    } >> "$SINGULARITY_ENVIRONMENT"


    # ================================
    # INSTALL mapseq
    # ================================
    VERSION="v1.2.6"
    apt-get install -y build-essential wget subversion git libncurses5-dev libtool automake autoconf
    git clone https://github.com/jfmrod/MAPseq.git
    cd MAPseq || exit 1
    git checkout "$VERSION"
    ./setup.sh
    ./bootstrap
    ./configure
    make
    make install
    cd "$HOME" || exit 1
