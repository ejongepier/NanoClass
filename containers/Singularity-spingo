Bootstrap: debootstrap
OSVersion: bionic
MirrorURL: http://us.archive.ubuntu.com/ubuntu/

%environment
    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8
    export LD_LIBRARY_PATH="/usr/local/lib:$LD_LIBRARY_PATH"

%post
    apt update
    apt install -y software-properties-common
    apt-add-repository universe
    apt update
    apt install -y git wget build-essential unzip python3-pip
    pip3 install biopython

    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8
    {
        echo "export PATH=/usr/local:/usr/local/bin:/usr/local/lib:$PATH"
        echo "export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH"
    } >> "$SINGULARITY_ENVIRONMENT"

    # ================================
    # INSTALL SPINGO
    # ================================
    VERSION="v1.3"
    git clone https://github.com/GuyAllard/SPINGO
    cd SPINGO || exit 1
    git checkout "$VERSION"
    cp spingo /usr/local/bin/
    cp spindex /usr/local/bin/
    cd "$HOME" || exit 1
